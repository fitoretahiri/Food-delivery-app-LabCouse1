{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Arber\\\\Documents\\\\GitHub\\\\Food-delivery-app-LabCouse1\\\\Food-delivery-app-LabCouse1\\\\front-end-code\\\\src\\\\LoginForm.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport useAuth from './hooks/useAuth';\nimport { useNavigate, useLocation, Link } from 'react-router-dom';\nimport axios, { axiosPrivate } from './api/axios';\nimport useAxiosPrivate from \"./hooks/useAxiosPrivate\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction LoginForm(props) {\n  _s();\n\n  var _location$state, _location$state$from;\n\n  //const axiosPrivate = useAxiosPrivate();\n  const {\n    setAuth,\n    persist,\n    setPersist\n  } = useAuth();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const from = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : (_location$state$from = _location$state.from) === null || _location$state$from === void 0 ? void 0 : _location$state$from.pathname) || \"/\";\n  const userRef = useRef();\n  const errRef = useRef();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [redirect, setRedirect] = useState(false);\n  const [role, setRole] = useState('');\n  const [errMsg, setErrMsg] = useState('');\n  useEffect(() => {\n    setErrMsg('');\n  }, [email, password]);\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const data = {\n      email: email,\n      password: password\n    };\n\n    try {\n      var _response$data, _response$data2, _response$data3;\n\n      const response = await axios.post('/api/authmanagement/login', data, {\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        withCredentials: true\n      });\n      const accessToken = response === null || response === void 0 ? void 0 : (_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.token;\n      const refreshToken = response === null || response === void 0 ? void 0 : (_response$data2 = response.data) === null || _response$data2 === void 0 ? void 0 : _response$data2.refreshToken;\n      const roles = response === null || response === void 0 ? void 0 : (_response$data3 = response.data) === null || _response$data3 === void 0 ? void 0 : _response$data3.roles;\n      console.log(accessToken);\n      console.log(refreshToken);\n      setAuth({\n        email,\n        password,\n        roles,\n        accessToken\n      });\n      navigate(from, {\n        replace: true\n      });\n    } catch (err) {\n      var _err$response, _err$response2;\n\n      if (!(err !== null && err !== void 0 && err.response)) {\n        setErrMsg('Serveri nuk ktheu pergjigje!');\n      } else if (((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status) === 400) {\n        setErrMsg('Te dhenat jane gabim');\n      } else if (((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : _err$response2.status) === 401) {\n        setErrMsg('Unauthorized');\n      } else {\n        setErrMsg('Kyqja ne sistem Deshtoi');\n      }\n    }\n  };\n\n  const togglePersist = () => {\n    setPersist(prev => !prev);\n  };\n\n  useEffect(() => {\n    localStorage.setItem(\"persist\", persist);\n  }, [persist]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"d-flex justify-content-center\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      autoComplete: \"off\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-90\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          ref: errRef,\n          className: errMsg ? \"alert alert-danger\" : \"collapse\",\n          role: \"alert\",\n          \"aria-live\": \"assertive\",\n          children: errMsg\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-outline mb-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"email\",\n            id: \"email\",\n            className: \"form-control\",\n            name: \"email\",\n            required: true,\n            onChange: e => setEmail(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"form-label\",\n            for: \"email\",\n            children: \"Email address\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-outline mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            id: \"password\",\n            className: \"form-control\",\n            name: \"password\",\n            required: true,\n            onChange: e => setPassword(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"form-label\",\n            for: \"password\",\n            children: \"Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"form-check\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            class: \"form-check-input\",\n            id: \"exampleCheck1\",\n            onChange: togglePersist,\n            checked: persist\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            class: \"form-check-label\",\n            for: \"exampleCheck1\",\n            children: \"Trust this Device\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"btn btn-primary btn-block mb-4\",\n          children: \"Sign in\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/admin\",\n          children: \"Admin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 11\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 9\n  }, this);\n}\n\n_s(LoginForm, \"VSdqdDX74asdaH/cPjZu5hohyv8=\", false, function () {\n  return [useAuth, useNavigate, useLocation];\n});\n\n_c = LoginForm;\nexport default LoginForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"LoginForm\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useAuth","useNavigate","useLocation","Link","axios","axiosPrivate","useAxiosPrivate","LoginForm","props","setAuth","persist","setPersist","navigate","location","from","state","pathname","userRef","errRef","email","setEmail","password","setPassword","redirect","setRedirect","role","setRole","errMsg","setErrMsg","handleSubmit","e","preventDefault","data","response","post","headers","withCredentials","accessToken","token","refreshToken","roles","console","log","replace","err","status","togglePersist","prev","localStorage","setItem","target","value"],"sources":["C:/Users/Arber/Documents/GitHub/Food-delivery-app-LabCouse1/Food-delivery-app-LabCouse1/front-end-code/src/LoginForm.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport useAuth from './hooks/useAuth';\r\n\r\nimport { useNavigate, useLocation, Link } from 'react-router-dom';\r\nimport axios, { axiosPrivate } from './api/axios';\r\nimport useAxiosPrivate from \"./hooks/useAxiosPrivate\";\r\n\r\n\r\n\r\nfunction LoginForm(props) {\r\n  //const axiosPrivate = useAxiosPrivate();\r\n\r\n  const { setAuth, persist, setPersist } = useAuth();\r\n\r\n\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const from = location.state?.from?.pathname || \"/\";\r\n\r\n  const userRef = useRef();\r\n  const errRef = useRef();\r\n\r\n  const [email, setEmail] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const [redirect, setRedirect] = useState(false)\r\n  const [role, setRole] = useState('')\r\n\r\n  const [errMsg, setErrMsg] = useState('');\r\n\r\n  useEffect(() => {\r\n    setErrMsg('');\r\n  }, [email, password])\r\n\r\n\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const data = {\r\n      email: email,\r\n      password: password\r\n    }\r\n\r\n    try {\r\n      const response = await axios.post('/api/authmanagement/login',\r\n        data,\r\n        {\r\n          headers: { 'Content-Type': 'application/json' },\r\n          withCredentials: true\r\n        }\r\n      );\r\n      \r\n      const accessToken = response?.data?.token;\r\n      const refreshToken = response?.data?.refreshToken;\r\n      const roles = response?.data?.roles\r\n\r\n      console.log(accessToken);\r\n      console.log(refreshToken);\r\n      \r\n      setAuth({ email, password, roles, accessToken});\r\n      navigate(from, { replace: true });\r\n    } catch (err) {\r\n      if (!err?.response) {\r\n        setErrMsg('Serveri nuk ktheu pergjigje!');\r\n      } else if (err.response?.status === 400) {\r\n        setErrMsg('Te dhenat jane gabim');\r\n      } else if (err.response?.status === 401) {\r\n        setErrMsg('Unauthorized');\r\n      } else {\r\n        setErrMsg('Kyqja ne sistem Deshtoi');\r\n      }\r\n    }\r\n  }\r\n\r\n  const togglePersist = () => {\r\n    setPersist(prev => !prev)\r\n  }\r\n\r\nuseEffect(() => {\r\n  localStorage.setItem(\"persist\", persist);\r\n}, [persist])\r\n\r\n  return (\r\n        <div className=\"d-flex justify-content-center\">\r\n          <form onSubmit={handleSubmit} autoComplete=\"off\">\r\n            <div className=\"w-90\">\r\n              {/*Alert Box*/}\r\n              <div ref={errRef} className={errMsg ? \"alert alert-danger\" : \"collapse\"} role=\"alert\" aria-live=\"assertive\">\r\n                {errMsg}\r\n              </div>\r\n              <h2>Login</h2>\r\n              <div className=\"form-outline mb-8\">\r\n                <input\r\n                  type=\"email\"\r\n                  id=\"email\"\r\n                  className=\"form-control\"\r\n                  name=\"email\"\r\n                  required\r\n                  onChange={(e) => setEmail(e.target.value)}\r\n                />\r\n                <label className=\"form-label\" for=\"email\">\r\n                  Email address\r\n                </label>\r\n              </div>\r\n\r\n              <div className=\"form-outline mb-4\">\r\n                <input\r\n                  type=\"password\"\r\n                  id=\"password\"\r\n                  className=\"form-control\"\r\n                  name=\"password\"\r\n                  required\r\n                  onChange={(e) => setPassword(e.target.value)}\r\n                />\r\n                <label className=\"form-label\" for=\"password\">\r\n                  Password\r\n                </label>\r\n              </div>\r\n              <div class=\"form-check\">\r\n              <input \r\n              type=\"checkbox\" \r\n              class=\"form-check-input\" \r\n              id=\"exampleCheck1\" \r\n              onChange={togglePersist}\r\n              checked={persist}\r\n              />\r\n              <label class=\"form-check-label\" for=\"exampleCheck1\">Trust this Device</label>\r\n            </div>\r\n              <button\r\n                type=\"submit\"\r\n                className=\"btn btn-primary btn-block mb-4\"\r\n              >\r\n                Sign in\r\n              </button>\r\n              <Link to='/admin'>Admin</Link>\r\n            </div>\r\n          </form>\r\n        </div>\r\n  )\r\n\r\n}\r\n\r\nexport default LoginForm;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}